#!/usr/bin/env python

import gmpy2
from gmpy2 import mpz

p = mpz('134078079299425970995740249982058461274793658205923933\
        77723561443721764030073546976801874298166903427690031\
        858186486050853753882811946569946433649006084171')

g = mpz('11717829880366207009516117596335367088558084999998952205\
        59997945906392949973658374667057217647146031292859482967\
        5428279466566527115212748467589894601965568')

h = mpz('323947510405045044356526437872806578864909752095244\
        952783479245297198197614329255807385693795855318053\
        2878928001494706097394108577585732452307673444020333')

B = 2**20

left = {}
for x in range(0, B + 1):
    left[gmpy2.divm(h, gmpy2.powmod(g, x, p), p)] = x

for x in range(0, B + 1):
    g_pow_B = gmpy2.powmod(g, B, p)
    right = gmpy2.powmod(g_pow_B, x, p)
    try:
        x0 = x
        x1 = left[right]
        x = x0 * B + x1
        print "x = %d" % x
        exit(0)
    except KeyError:
        pass
